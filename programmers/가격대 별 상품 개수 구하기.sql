-- SELECT 
-- CASE 
-- WHEN PRICE BETWEEN 0 AND 9999 THEN 0
-- WHEN PRICE BETWEEN 10000 AND 19999 THEN 10000
-- WHEN PRICE BETWEEN 20000 AND 29999 THEN 20000
-- WHEN PRICE BETWEEN 30000 AND 39999 THEN 30000
-- WHEN PRICE BETWEEN 40000 AND 49999 THEN 40000
-- WHEN PRICE BETWEEN 50000 AND 59999 THEN 50000
-- WHEN PRICE BETWEEN 60000 AND 69999 THEN 60000
-- WHEN PRICE BETWEEN 70000 AND 79999 THEN 70000
-- WHEN PRICE BETWEEN 80000 AND 89999 THEN 80000
-- ELSE NULL 
-- END AS PRICE_GROUP, COUNT(PRODUCT_CODE) AS PRODUCTS
-- FROM PRODUCT
-- GROUP BY PRICE_GROUP
-- ORDER BY PRICE_GROUP

-- 처음 쓴 쿼리문, 정답 처리는 되나 비효율적

SELECT FLOOR(PRICE / 10000) * 10000 AS PRICE_GROUP, COUNT(PRODUCT_CODE) AS PRODUCTS
FROM PRODUCT
GROUP BY PRICE_GROUP
ORDER BY PRICE_GROUP;

-- 개선 쿼리문, FLOOR 함수를 통해 반내림으로 구간 설정, 예를 들어 가격이 23000원이면 20000원 그룹에 들어가게 됨
